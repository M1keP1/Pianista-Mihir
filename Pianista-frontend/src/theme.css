/* Defaults to classic to prevent first-paint flash */
:root {
  --color-bg: #1f1f1f;
  --color-text: #e5e5e5;
  --color-text-secondary: #a0a0a0;
  --color-surface: rgba(255, 255, 255, 0.05);
  --color-accent: #ff0000;
  --color-border-muted: color-mix(in srgb, #ff5f2e 40%, transparent);
  --color-shadow: rgba(0,0,0,0.35); 
  --font-sans: "Open Sans", ui-sans-serif, system-ui, -apple-system, "Segoe UI",
               Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
               "Segoe UI Emoji", "Segoe UI Symbol";
}
/* Use Open Sans globally */
html, body {
  font-family: var(--font-sans);
}

/* Classic (Dark) — calm indigo accent */
:root[data-theme="classic"] {
  --color-bg: #0b0f14;                 /* deep blue-black */
  --color-text: #e6eaf2;               /* high-contrast, soft white */
  --color-text-secondary: #9aa4b2;     /* desaturated slate */
  --color-surface: rgba(255, 255, 255, 0.06); /* chat bubbles / cards */
  --color-accent: #4f46e5;             /* indigo-600 */
  --color-border-muted: color-mix(in srgb, var(--color-accent) 28%, transparent);
  --color-shadow: rgba(0, 0, 0, 0.5);
  --color-star: #e6eaf2;               /* if you still use stars */
  --color-surface-bridge: color-mix(in srgb, var(--color-bg) 85%, white 15%);
    --tooltip-bg: rgba(20,20,20,.95);
  --tooltip-fg: #fff;
  --tooltip-border: rgba(255,255,255,.15);
  --tooltip-shadow: rgba(0,0,0,.5);

}

/* Light — airy with same accent for brand consistency */
:root[data-theme="light"] {
  --color-bg: #eeece2;                 /* off-white with a hint of blue */
  --color-text: #0b0f14;               /* near-black for crisp copy */
  --color-text-secondary: #5b6472;     /* cool gray for meta text */
  --color-surface: rgba(255, 255, 255, 0.92); /* subtle card glass */
  --color-accent: #da7756 ;             /* same indigo accent */
  --color-border-muted: color-mix(in srgb, var(--color-accent) 30%, transparent);
  --color-shadow: rgba(0, 0, 0, 0.08);
  --color-star: #2d3748;
  --color-surface-bridge: color-mix(in srgb, var(--color-bg) 88%, black 12%);
    --tooltip-bg: rgba(255,255,255,.98);
  --tooltip-fg: #0b0f14;
  --tooltip-border: rgba(0,0,0,.18);
  --tooltip-shadow: rgba(0,0,0,.18);

}

/* --- add near the top with other :root tokens --- */
:root {
  /* ...existing vars... */
  --color-surface-bridge: color-mix(in srgb, var(--color-bg) 85%, white 15%);
}

/* --- Outline: default looks hovered; hover/active become more solid --- */
.btn--outline.is-hover-default {
  background: color-mix(in srgb, var(--color-accent) 15%, transparent);
}
.btn--outline.is-hover-default:hover {
  background: color-mix(in srgb, var(--color-accent) 32%, transparent);
  transform: translateZ(0) scale(1.008);
}
.btn--outline.is-hover-default:active {
  background: var(--color-accent);
  color: #fff;
  border-color: color-mix(in srgb, var(--color-accent) 55%, var(--color-border-muted));
  transform: scale(0.97);
}




/* ========== Pill Button Base ========== */

/* Base button: rectangular with rounded edges */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  font-family: monospace;
  text-decoration: none;
  user-select: none;
  cursor: pointer;
  border: 1px solid var(--color-border-muted);
  box-shadow: 0 1.5px 8px 0 var(--color-shadow);
  will-change: transform, background-color, border-color, color, box-shadow;
  transition:
    transform 110ms ease,
    background-color 120ms ease,
    color 120ms ease,
    border-color 120ms ease,
    box-shadow 120ms ease;
}
.btn:focus-visible {
  outline: 2px solid color-mix(in srgb, var(--color-accent) 70%, transparent);
  outline-offset: 2px;
}
.btn.is-disabled, .btn[disabled] { opacity: .65; pointer-events: none; }

/* Sizes */
.btn--sm { padding: .5rem 1rem; font-size: .9rem; }
.btn--md { padding: .65rem 1.4rem; font-size: .95rem; }
.btn--lg { padding: .8rem 1.8rem; font-size: 1rem; }
.is-full { width: 100%; }

/* Variants */
.btn--primary {
  background: var(--color-accent);
  color: #fff;
  border-color: color-mix(in srgb, var(--color-accent) 35%, var(--color-border-muted));
}
.btn--primary:hover {
  background: color-mix(in srgb, var(--color-accent) 90%, white 10%);
  box-shadow: 0 3px 14px 0 color-mix(in srgb, var(--color-accent) 28%, var(--color-shadow));
  transform: translateZ(0) scale(1.012);
}
.btn--primary:active { transform: scale(0.97); }

.btn--primary.is-disabled, 
.btn--primary[disabled] {
  background: color-mix(in srgb, var(--color-accent) 90%, white 10%);
  opacity: 1; /* Override the default .65 opacity */
}
.btn--surface {
  background: var(--color-surface);
  color: var(--color-text);
}
.btn--surface:hover {
  background: color-mix(in srgb, var(--color-surface) 85%, var(--color-accent) 15%);
  transform: translateZ(0) scale(1.008);
}
.btn--surface:active { transform: scale(0.97); }

.btn--outline {
  background: transparent;
  color: var(--color-text);
  border-color: color-mix(in srgb, var(--color-accent) 50%, var(--color-border-muted));
}
.btn--outline:hover {
  background: color-mix(in srgb, var(--color-accent) 15%, transparent);
  transform: translateZ(0) scale(1.008);
}
.btn--outline:active { transform: scale(0.97); }

/* Inner */
.btn__inner { display: inline-flex; align-items: center; gap: .5rem; }
.btn__icon { display: inline-flex; }
.btn__icon--left  { margin-inline-start: -0.1rem; }
.btn__icon--right { margin-inline-end: -0.1rem; }

/* Textarea placeholder + disabled state (theme-aware) */
textarea[data-p-textarea]::placeholder { color: var(--color-text-secondary); opacity: .9; }
textarea[data-p-textarea]:disabled { opacity: .65; cursor: not-allowed; }

/* Textarea placeholder + disabled (already suggested) */
textarea[data-p-textarea]::placeholder { color: var(--color-text-secondary); opacity: .9; }
textarea[data-p-textarea]:disabled { opacity: .65; cursor: not-allowed; }

/* Firefox */
textarea[data-p-textarea],
[data-themed-scroll] {
  scrollbar-width: thin;                  /* slimmer in FF */
  scrollbar-color: color-mix(in srgb, var(--color-accent) 45%, var(--color-border-muted)) transparent;
  scrollbar-gutter: stable both-edges;    /* keeps a gutter so it doesn't hug content edges */
}

/* WebKit (Chrome/Edge/Safari) */
textarea[data-p-textarea]::-webkit-scrollbar,
[data-themed-scroll]::-webkit-scrollbar {
  width: 4px;
}

textarea[data-p-textarea]::-webkit-scrollbar-track,
[data-themed-scroll]::-webkit-scrollbar-track {
  background: color-mix(in srgb, var(--color-bg) 60%, transparent);
  border-radius: 10px;
  background-clip: padding-box;
  border: 3px solid transparent;          /* insets track so it doesn’t touch container sides */
}

textarea[data-p-textarea]::-webkit-scrollbar-thumb,
[data-themed-scroll]::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--color-accent) 55%, var(--color-border-muted));
  border-radius: 10px;
  /* create top/bottom “caps” so the thumb never touches the ends */
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  /* keep slight side insets too */
  border-left: 2px solid transparent;
  border-right: 2px solid transparent;
  background-clip: padding-box;
}

textarea[data-p-textarea]::-webkit-scrollbar-thumb:hover,
[data-themed-scroll]::-webkit-scrollbar-thumb:hover {
  background: color-mix(in srgb, var(--color-accent) 70%, var(--color-border-muted));
}


/* ===== Textarea Glow States (theme-aware) ===== */
@keyframes pulseGlow {
  0%   { box-shadow: 0 0 6px 1px var(--glow-color, var(--color-accent)); }
  50%  { box-shadow: 0 0 14px 3px var(--glow-color, var(--color-accent)); }
  100% { box-shadow: 0 0 6px 1px var(--glow-color, var(--color-accent)); }
}

textarea[data-p-textarea].glow--verification {
  --glow-color: color-mix(in srgb, var(--color-accent) 80%, #10b981);
  border-color: var(--glow-color);
  animation: pulseGlow 1.4s linear infinite;
}

textarea[data-p-textarea].glow--verified {
  --glow-color: #22c55e; /* green */
  border-color: var(--glow-color);
  box-shadow: 0 0 10px 2px var(--glow-color);
}

textarea[data-p-textarea].glow--error {
  --glow-color: #ef4444; /* red */
  border-color: var(--glow-color);
  box-shadow: 0 0 10px 2px var(--glow-color);
}

textarea[data-p-textarea].glow--ai-thinking {
  --glow-color: #3b82f6; /* blue */
  border-color: var(--glow-color);
  animation: pulseGlow 1.6s ease-in-out infinite;
}
/* ===== Status pill (pure CSS, theme-aware) ===== */
.status-pill {
  position: absolute;
  top: 8px;
  right: 12px;
  width: 26px;
  height: 26px;
  display: grid;
  place-items: center;
  border-radius: 999px;
  border: 1px solid var(--color-border-muted);
  box-shadow: 0 1px 6px var(--color-shadow);
  background: transparent;
  color: var(--color-text);
  z-index: 2; /* keep above textarea paint */
}
.status-pill.is-left { left: 12px; right: auto; }

/* State colors (background + fg color) */
.status-pill[data-state="verification"] { background: rgba(16,185,129,.12); color: var(--color-accent); }
.status-pill[data-state="verified"]     { background: rgba(34,197,94,.12);  color: #22c55e; }
.status-pill[data-state="error"]        { background: rgba(239,68,68,.12);  color: #ef4444; }
.status-pill[data-state="ai-thinking"]  { background: rgba(59,130,246,.12); color: #3b82f6; }

/* Icon sizing (for your external SVGs) */
.status-icon { width: 16px; height: 16px; display: block; }

/* Optional spinner animation (apply .spin class to the icon node) */
@keyframes spin { to { transform: rotate(1turn); } }
.spin { animation: spin 1s linear infinite; }

/* MermaidPanel busy glow (unchanged) */
section[data-busy-glow="true"] {
  animation: mmPanelGlow 1.2s ease-in-out infinite;
  border-color: color-mix(in srgb, var(--color-accent) 45%, var(--color-border-muted));
  box-shadow:
    0 1px 10px color-mix(in srgb, var(--color-shadow) 70%, transparent),
    0 0 0 4px color-mix(in srgb, var(--color-accent) 12%, transparent);
}

/* ===== Inline side-hint INSIDE the textarea =====
   Shows next to the pill; never escapes the container.
   Works on :hover and :focus (so click-to-pin if element is focusable). */
.status-pill[data-hint]::after,
.status-pill[data-hint]::before {
  position: absolute;
  opacity: 0;
  pointer-events: none;
  transition: opacity .12s ease, transform .12s ease;
  z-index: 3; /* above pill */
}

/* Bubble body */
.status-pill[data-hint]::after {
  content: attr(data-hint);
  top: 50%;
  transform: translateY(-50%);
  padding: 4px 10px;
  font-size: 12px;
  line-height: 1.2;
  border-radius: 999px; /* pill-shaped */
  background: color-mix(in srgb, var(--color-bg) 88%, var(--color-surface));
  border: 1px solid var(--color-border-muted);
  box-shadow: 0 1px 6px var(--color-shadow) inset;
  color: var(--color-text);
  white-space: nowrap;         /* keeps pill shape */
  max-width: 65ch;             /* avoid huge pills */
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Arrow (small diamond) */
.status-pill[data-hint]::before {
  content: "";
  top: 50%;
  width: 8px; height: 8px;
  background: color-mix(in srgb, var(--color-bg) 88%, var(--color-surface));
  transform: translateY(-50%) rotate(45deg);
  box-shadow: 0 0 0 1px var(--color-border-muted) inset;
}

/* If the pill is on the LEFT, place bubble to its RIGHT (inside the textarea) */
.status-pill.is-left[data-hint]::after { left: calc(100% + 8px); }
.status-pill.is-left[data-hint]::before { left: calc(100% + 2px); }

/* Default (pill on the RIGHT): place bubble to its LEFT (inside the textarea) */
.status-pill:not(.is-left)[data-hint]::after { right: calc(100% + 8px); }
.status-pill:not(.is-left)[data-hint]::before { right: calc(100% + 2px); }

/* Reveal on hover OR focus (click pins if the pill can receive focus) */
.status-pill[data-hint]:is(:hover, :focus)::after,
.status-pill[data-hint]:is(:hover, :focus)::before {
  opacity: 1;
}

/* Small helper note under editors */
.field-hint {
  margin-top: 6px;
  font-size: 12px;
  line-height: 1.25;
  color: var(--color-text-muted, color-mix(in srgb, var(--color-text) 55%, transparent));
  user-select: none;
}

/* Generic glow utilities (match textarea glows) */
.glow--verification {
  --glow-color: color-mix(in srgb, var(--color-accent) 80%, #10b981);
  border-color: var(--glow-color) !important;
  animation: pulseGlow 1.4s linear infinite;
}
.glow--ai-thinking {
  --glow-color: #3b82f6;
  border-color: var(--glow-color) !important;
  animation: pulseGlow 1.6s ease-in-out infinite;
}
.glow--error {
  --glow-color: #ef4444;
  border-color: var(--glow-color) !important;
  box-shadow: 0 0 10px 2px var(--glow-color);
}
.glow--verified {
  --glow-color: #22c55e;
  border-color: var(--glow-color) !important;
  box-shadow: 0 0 10px 2px var(--glow-color);
}

/* Chip container (same look/height as footer chip) */
.footer-chip {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 4px 16px;                 /* same vertical height */
  border-radius: 8px;
  border: 1px solid color-mix(in srgb, var(--color-accent) 20%, transparent);
  background: color-mix(in srgb, var(--color-bg) 20%, transparent);
  backdrop-filter: blur(6px);
  box-shadow: 0 2px 12px var(--color-shadow);
}
:root{
  /* tweak this to nudge the dock horizontally relative to page center */
  --actions-offset: 220px;
}

/* Floating actions dock at same level as footer (not fused) */
.actions-dock {
  position: fixed;
  left: 50%;
  bottom: 3px;                 /* same bottom spacing as footer chip */
  transform: translateX(var(--actions-offset));
  z-index: 11;                 /* above content; below modals */
  display: inline-flex;
  align-items: center;
  gap: 10px;
  pointer-events: none;        /* so it doesn’t block page clicks... */
}
.actions-dock > * { pointer-events: auto; } /* ...but its children do */

/* optional: visually align height with footer chip without adding a box */
.actions-dock .control-lane {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  height: 40px;                /* matches typical footer chip height */
}

/* Reserve space for the reset icon button so layout doesn't jump */
.reset-slot {
  width: 44px;            /* tweak if your icon PillButton is wider/narrower */
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 0 0 44px;
}
@media (max-width: 560px) {
  .reset-slot { width: 40px; flex-basis: 40px; }
}
